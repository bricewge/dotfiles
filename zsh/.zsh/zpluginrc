# zplugin configuration

# * zplugin
source "$ZPLGM[BIN_DIR]/zplugin.zsh"

local ice_defaults
ice_default="wait'1' silent"

# * theme
. ~/.zsh/theme.zsh

# reload the theme with signal USR1
TRAPUSR1() {
    . ~/.zsh/theme.zsh
}

# * prompt
autoload -U promptinit

zplugin ice wait'0a' silent
zplugin load mafredri/zsh-async

PS1="‚ùØ " # display before promtp is load ~100ms
zplugin ice wait'0b' silent \
    atload"fpath+=(\$PWD) && promptinit && prompt pure && zle .reset-prompt"
zplugin load 'sindresorhus/pure'

# * man
zplugin ice $ice_defaults
zplugin load 'zlsun/solarized-man'

# * prezto
# Set the key mapping style to 'emacs' or 'vi'.
zstyle ':prezto:module:editor' key-bindings 'emacs'
# Auto convert .... to ../..
zstyle ':prezto:module:editor' dot-expansion 'yes'
# Colorize outputs
zstyle ':prezto:module:utility:ls'    color 'yes'
zstyle ':prezto:module:utility:diff'  color 'yes'
zstyle ':prezto:module:utility:wdiff' color 'yes'
zstyle ':prezto:module:utility:make'  color 'yes'

zstyle ':prezto:load' pmodule \
    'editor' \
    'history' \
    'directory' \
    'command-not-found' \
    'spectrum' \
    'utility'

zplugin ice $ice_defaults src'init.zsh'
zplugin load 'sorin-ionescu/prezto'

# * completions
zplugin ice $ice_defaults blockf
zplugin load 'zsh-users/zsh-completions'

# * UI
# ** notify
zstyle ':notify:*' command-complete-timeout 15
zplugin ice $ice_defaults
zplugin load 'marzocchi/zsh-notify'

# ** autosuggestion
zplugin ice $ice_defaults atload'_zsh_autosuggest_start'
zplugin load zsh-users/zsh-autosuggestions

ZSH_AUTOSUGGEST_CLEAR_WIDGETS+=(history-substring-search-up history-substring-search-down)

# ** history
function _history_substring_search_config() {
    bindkey "$terminfo[kcuu1]" history-substring-search-up
    bindkey "$terminfo[kcud1]" history-substring-search-down
    bindkey '^[[A' history-substring-search-up
    bindkey '^[[B' history-substring-search-down
    bindkey -M emacs '^P' history-substring-search-up
    bindkey -M emacs '^N' history-substring-search-down
}

# NOTE It should be loaded after zsh-syntax-highlighting
# https://github.com/zsh-users/zsh-history-substring-search#usage
zplugin ice wait'1' silent atload'_history_substring_search_config'
zplugin load 'zsh-users/zsh-history-substring-search'


# ** syntax highlighting
zplugin ice $ice_defaults
zplugin load zsh-users/zsh-syntax-highlighting

# Local Variables:
# mode: sh
# End:
