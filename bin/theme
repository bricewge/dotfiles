#!/usr/bin/env sh
#
# Toogle betwen dark and light themes

set -e

state_file="${XDG_RUNTIME_DIR}/theme"

if [ -n "$1" ]; then
    theme=$([ "$1" = "dark" ] && echo dark || echo light )
elif [ -e "${state_file}" ]; then
    theme=$([ $(cat "${state_file}") = "light" ] && echo dark || echo light )
else
    theme="light"
fi

echo "${theme}" > "${state_file}"

ln -sf "${XDG_CONFIG_HOME}/polybar/solarized-${theme}" "${XDG_CONFIG_HOME}/polybar/colors"
pkill -USR1 polybar
sed -i "s/\(^colors: \*\).*/\1${theme}/g" "${XDG_CONFIG_HOME}/alacritty/alacritty.yml"
# TODO Add tmux support
# TODO Add firefox support
emacsclient --eval "(load-theme 'solarized-${theme})"
